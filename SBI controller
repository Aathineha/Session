@RestController
@RequestMapping("/device")
public class SbiController {

    @Autowired
    private SessionService sessionService;

    @PostMapping("/login")
    public ResponseEntity<Boolean> loginDevices(@RequestBody List<DeviceDTO> devices) {
        for (DeviceDTO device : devices) {
            String sessionId = UUID.randomUUID().toString();
            sessionService.storeSession(device.getNeId(), device.getIpAddress(), sessionId);
        }
        return ResponseEntity.ok(true);
    }

    @PostMapping("/logout")
    public ResponseEntity<Boolean> logoutDevices(@RequestBody List<LogoutRequest> logoutRequests) {
        for (LogoutRequest request : logoutRequests) {
            sessionService.removeSession(request.getNeId(), request.getIpAddress());
        }
        return ResponseEntity.ok(false); // false = logout
    }

    @GetMapping("/sessions")
    public ResponseEntity<Map<String, String>> getAllSessions() {
        return ResponseEntity.ok(sessionService.getAllSessions());
    }
}